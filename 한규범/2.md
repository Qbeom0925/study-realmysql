# 2장 MySQL 서버 업그레이드

MySQL 서버를 업그레이드하는 방법으로 다음의 두 가지 방법을 생각해볼 수 있다.

1. MySQL 서버의 데이터 파일을 그대로 뚜고 업그레이드하는 방법
2. mysqldump 도구 등을 이용해 MySQL 서버의 데이터를 SQL 문장이나 텍스트 파일로 덤프한 후, 새로 업그레이드된 버전의 MySQL 서버에서 덤프된 데이터를 적재하는 방법

1번의 경우 ‘인플레이스 업그레이드(In-Place Upgrade)’라고 하며, 2번을 ‘논리적 업그레이드(Logical Upgrade)’라고 한다. 

## 인플레이스 업그레이드 제약 사항

- MySQL 버전이 만약 두 단계 이상을 한번에 업그레이드를 해야하는 상황이라면 mysqldump 프로그램으로 서버에서 데이터를 백업받은 후 새로 구축된 MySQL 8.0 서버에 데이터를 적재하는 논리적 업그레이드가 더 나은 방법일 수도 있다.

## MySQL 8.0 업그레이드 시 고려 사항

MySQL 5.7버전에 비해서 변경점

- 사용자 인증 방식 변경 : 8.0 버전부터는 Caching SHA-2 Authentication 인증 방식이 기본 인증 방식으로 바뀌었다. MySQL 5.7에 존재했던 사용자가 계정은 여전히 Native Auththentication 인증 방식을 사용 하게 될 것이다. 만약 Native Authentication을 계속 사용하고자 한다면 MySQL서버를 시작할 때 —default-authentication-plugin=mysql_native_password 파라미터를 활성화 하자
- MySQL 8.0과의 호환성 체크: MySQL 8.0 업그레이드 전에 MySQL 5.7 버전에서는 손상관 FRM 파일이나 호환되지않는 데이터 타입 또는 함수가 있는지 mysqlcheck 유틸리티를 이용해 확인해 볼것
- 외래키 이름의 길이: MySQL 8.0에서는 외래키의 이름이 64글자로 제한된다.
- 인덱스 힌트: MySQL 5.x에서 사용되던 인덱스 힌트가 있다면, MySQL 8.0에서 먼저 성능 테스트를 수행하자.
- GROUP BY에 사용된 정렬 옵션: MySQL 5.x에서 GROUP BY 절의 컬럼 뒤에 ‘ASC’나 ‘DESC’를 사용하고 있다면 먼저 제거하거나 다른 방식으로 변경해야한다.
- 파티션을 위한 공용 테이블스페이스: MySQL 8.x에서는 파티션의 각 테이블스페이스를 공용 테이블 스페이스에 저장할 수 없다.

## MySQL 시스템 변수의 특징

MySQL 서버는 기동하면서 설정 파일의 내용을 읽어 메모리나 작동 방식을 초기화하고, 접속된 사용자를 제어하기 위해 이러한 값을 별도로 저장해 둔다.

## 글로벌 변수와 세션 변수

MySQL의 시스템 변수는 적용 범위에 따라 글로벌 변수와 세션 변수로 나뉜다. 세션별로 적용되는 시스템 변수의 경우 글로벌 변수 뿐만 아니라 세션 변수에도 동시에 존재한다. 이러한 경우 MySQL 매뉴얼의 ‘Var Scope’에는 ‘Both’라고 표시된다.

## 정적 변수와 동적 변수

MySQL 서버의 시스템 변수는 MySQL 서버가 가동 중인 상태에서 변경 가능한지에 따라 동적 변수와 정적 변수로 구분된다. MySQL 서버의 시스템 변수는 디스크에 저장돼 있는 설정 파일을 변경하는 경우와 이미 가동 중인 MySQL 서버의 메모리에 있는 MySQL 서버의 시스템 변수를 변경하는 경우로 구분할 수 있다.

- 동적 변수의 경우, ‘SET GLOBAL’명령어로 변경하면 즉시 MySQL에 반영된다.